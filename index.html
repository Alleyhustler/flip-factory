<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flip Factory - Buy. Flip. Loop. Repeat.</title>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Lexend", sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%);
            color: #e0e0e0;
            min-height: 100vh;
            position: relative;
        }

        /* FIX: Move background to body instead of ::before to avoid blocking clicks */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('background.png');
            background-size: cover;
            background-position: center;
            opacity: 0.15;
            z-index: -1; /* FIX: Send to background */
            pointer-events: none; /* FIX: Prevent blocking clicks */
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            background: rgba(0, 0, 0, 0.8);
            border-bottom: 2px solid #ffeb3b;
            padding: 20px;
            margin-bottom: 30px;
            position: relative; /* FIX: Ensure header is above background */
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            position: relative;
            z-index: 101;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
            position: relative;
            z-index: 102;
        }

        .logo {
            width: 100px;
            height: 100px;
            object-fit: contain;
        }

        .logo-placeholder {
            width: 60px;
            height: 60px;
            background: #ffeb3b;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            color: #000;
        }

        h1 {
            font-size: 32px;
            color: #ffeb3b;
            margin-bottom: 5px;
            position: relative;
            z-index: 102;
        }

        .subtitle {
            color: #888;
            font-size: 14px;
            position: relative;
            z-index: 102;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
            position: relative;
            z-index: 102;
        }

        .twitter-link {
            color: #ffeb3b;
            text-decoration: none;
            font-size: 14px;
            transition: color 0.3s;
            position: relative;
            z-index: 103;
            padding: 8px 12px;
            border: 1px solid transparent;
            border-radius: 4px;
        }

        .twitter-link:hover {
            color: #6bb5ff;
            border-color: #6bb5ff;
        }

        .wallet-btn {
            padding: 12px 24px;
            background: #ffeb3b;
            color: #000;
            border: none;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            transition: background 0.3s;
            position: relative;
            z-index: 103;
            border-radius: 4px;
        }

        .wallet-btn:hover {
            background: #6bb5ff;
        }

        .wallet-btn.connected {
            background: #28a745;
        }

        /* Main Content */
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        /* Card Style */
        .card {
            background: rgba(20, 20, 20, 0.9);
            border: 1px solid #333;
            padding: 25px;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }

        .card-title {
            font-size: 20px;
            color: #ffeb3b;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #333;
        }

        /* Item Display */
        .item-image {
            width: 100%;
            height: 350px;
            background: rgba(74, 158, 255, 0.1);
            border: 1px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            object-fit: cover;
        }

        .item-placeholder {
            font-size: 100px;
        }

        .item-stats {
            background: #000;
            padding: 20px;
            border: 1px solid #333;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #222;
        }

        .stat-row:last-child {
            border-bottom: none;
        }

        .stat-label {
            color: #888;
        }

        .stat-value {
            color: #ffeb3b;
            font-weight: bold;
        }

        /* Progress Bar */
        .progress-container {
            margin: 20px 0;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #111;
            border: 1px solid #333;
            position: relative;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ffeb3b, #6bb5ff);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000;
            font-weight: bold;
        }

        .progress-text {
            text-align: right;
            margin-top: 5px;
            font-size: 14px;
            color: #888;
        }

        /* Status Alert */
        .status-alert {
            background: #ff9800;
            color: #000;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            font-weight: bold;
        }

        /* Fund Button */
        .fund-btn {
            width: 100%;
            padding: 15px;
            background: #ffeb3b;
            color: #000;
            border: none;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            font-weight: bold;
            transition: background 0.3s;
        }

        .fund-btn:hover:not(:disabled) {
            background: #6bb5ff;
        }

        .fund-btn:disabled {
            background: #333;
            color: #666;
            cursor: not-allowed;
        }

        /* Queue Items */
        .queue-item {
            background: rgba(74, 158, 255, 0.05);
            border: 1px solid #333;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .queue-details {
            font-size: 12px;
            color: #888;
        }

        /* How It Works */
        .how-it-works {
            padding: 20px;
            height: 100%;
        }

        .how-it-works h2 {
            font-size: 24px;
            color: #ffeb3b;
            margin-bottom: 20px;
            text-align: center;
        }

        .how-it-works p {
            margin-bottom: 15px;
            line-height: 1.6;
            color: #aaa;
            font-size: 14px;
        }

        .how-it-works .tagline {
            color: #ffeb3b;
            font-weight: bold;
            margin-top: 20px;
            font-size: 16px;
            text-align: center;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #1a1a1a;
            border: 2px solid #ffeb3b;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            position: relative;
            z-index: 1001;
        }

        .modal-title {
            font-size: 24px;
            color: #ffeb3b;
            margin-bottom: 20px;
        }

        .modal-input {
            width: 100%;
            padding: 12px;
            background: #000;
            border: 1px solid #333;
            color: #ffeb3b;
            font-family: 'Courier New', monospace;
            margin-bottom: 15px;
        }

        .modal-info {
            background: rgba(74, 158, 255, 0.1);
            padding: 12px;
            margin-bottom: 20px;
            color: #888;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
        }

        .modal-btn {
            flex: 1;
            padding: 12px;
            border: none;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            transition: all 0.3s;
        }

        .modal-btn.confirm {
            background: #ffeb3b;
            color: #000;
        }

        .modal-btn.confirm:hover {
            background: #6bb5ff;
        }

        .modal-btn.cancel {
            background: transparent;
            border: 1px solid #666;
            color: #888;
        }

        .modal-btn.cancel:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        /* Wallet Modal */
        .wallet-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }

        .wallet-option {
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid #333;
            color: #ffeb3b;
            cursor: pointer;
            text-align: left;
            transition: all 0.3s;
        }

        .wallet-option:hover {
            background: rgba(255, 235, 59, 0.1);
            border-color: #ffeb3b;
        }

        /* New Layout Styles */
        .content-grid {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .how-it-works-card {
            grid-column: 1;
            height: fit-content;
        }

        .current-flip-card {
            grid-column: 2;
        }

        .upcoming-flips-card {
            grid-column: 1 / span 2;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 24px;
            }

            .item-image {
                height: 250px;
            }

            .item-placeholder {
                font-size: 60px;
            }

            .queue-item {
                flex-direction: column;
                align-items: flex-start;
            }

            .content-grid {
                grid-template-columns: 1fr;
            }

            .how-it-works-card {
                grid-column: 1;
            }

            .current-flip-card {
                grid-column: 1;
            }

            .upcoming-flips-card {
                grid-column: 1;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo-section">
                <img src="RugCats Live LOGO (1).png" alt="Flip Factory" class="logo" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex'">
                <div class="logo-placeholder" style="display: none;">FF</div>
                <div>
                    <h1>FLIP FACTORY</h1>
                    <div class="subtitle">Buy. Flip. Loop. Repeat.</div>
                </div>
            </div>
            <div class="header-right">
                <a href="https://x.com/FlipFactory" target="_blank" class="twitter-link">üê¶ Twitter</a>
                <button class="wallet-btn" id="walletBtn">Connect Wallet</button>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="main-content">
            <!-- New Grid Layout -->
            <div class="content-grid">
                <!-- How It Works - Left Side -->
                <div class="card how-it-works-card">
                    <div class="how-it-works">
                        <h2>HOW IT WORKS</h2>
                        <p>Flip Factory converts PumpFun coin dev rewards into capital.</p>
                        <p>Capital buys random items from online markets.</p>
                        <p>DAO flips items for profit.</p>
                        <p>Profits are used for token buybacks and airdrops to holders.</p>
                        <p class="tagline">There is no top. There is no end.</p>
                    </div>
                </div>

                <!-- Current Item - Right Side -->
                <div class="card current-flip-card">
                    <div class="card-title">CURRENT FLIP</div>
                    <img src="a.jpg" alt="Current Item" class="item-image" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex'">
                    <div class="item-image item-placeholder" style="display: none;">üì¶</div>
                    
                    <div class="item-stats">
                        <div class="stat-row">
                            <span class="stat-label">ITEM:</span>
                            <span class="stat-value" id="itemName">Motorcycle listed on FB</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">SOURCE:</span>
                            <span class="stat-value" id="itemSource">Facebook Marketplace</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">COST TO ACQUIRE:</span>
                            <span class="stat-value" id="itemCost">3.3 SOL</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">EST. FLIP PROFIT:</span>
                            <span class="stat-value" id="itemProfit">+0.8 SOL</span>
                        </div>
                    </div>

                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill" style="width: 41%">
                                <span id="progressText">41%</span>
                            </div>
                        </div>
                        <div class="progress-text" id="progressPercent">Progress: 41%</div>
                    </div>

                    <div id="statusAlert" style="display: none;" class="status-alert"></div>

                    <button class="fund-btn" id="fundBtn">FUND THIS FLIP</button>
                </div>
            </div>

            <!-- Queue - Below Both Sections -->
            <div class="card upcoming-flips-card">
                <div class="card-title">UPCOMING FLIPS</div>
                <div id="queueList"></div>
            </div>
        </div>
    </div>

    <!-- Fund Modal -->
    <div class="modal" id="fundModal">
        <div class="modal-content">
            <div class="modal-title">FUND THIS FLIP</div>
            <label style="color: #888; margin-bottom: 10px; display: block;">Enter contribution amount (in SOL):</label>
            <input type="number" step="0.01" class="modal-input" id="fundInput" placeholder="0.00">
            <div class="modal-info">
                Current pool progress: <span id="modalProgress">41</span>%
            </div>
            <div class="modal-buttons">
                <button class="modal-btn confirm" id="confirmBtn">CONFIRM</button>
                <button class="modal-btn cancel" id="cancelBtn">CANCEL</button>
            </div>
        </div>
    </div>

    <!-- Wallet Modal -->
    <div class="modal" id="walletModal">
        <div class="modal-content">
            <div class="modal-title">CONNECT WALLET</div>
            <div class="wallet-options">
                <button class="wallet-option" id="phantomBtn">Phantom</button>
                <button class="wallet-option" id="solflareBtn">Solflare</button>
                <button class="wallet-option" id="backpackBtn">Backpack</button>
                <button class="wallet-option" id="demoBtn">Demo Mode (No Wallet Required)</button>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn cancel" id="closeWalletBtn">CLOSE</button>
            </div>
        </div>
    </div>

    <script>
        // State
        let state = {
            connected: false,
            walletAddress: null,
            progress: 41,
            flipping: false,
            flipTimer: 0,
            currentItem: {
                name: 'Motorcycle listed on FB',
                source: 'Facebook Marketplace',
                cost: 3.3,
                profit: 0.8
            },
            queue: [
                { name: 'Mystery Temu Drone', cost: 1.2, profit: 0.4 },
                { name: 'Retro GPU Frame', cost: 0.8, profit: 0.3 },
                { name: 'Fake Rolex (AliExpress)', cost: 0.4, profit: 0.2 }
            ]
        };

        // Elements
        const walletBtn = document.getElementById('walletBtn');
        const fundBtn = document.getElementById('fundBtn');
        const fundModal = document.getElementById('fundModal');
        const walletModal = document.getElementById('walletModal');
        const confirmBtn = document.getElementById('confirmBtn');
        const cancelBtn = document.getElementById('cancelBtn');
        const closeWalletBtn = document.getElementById('closeWalletBtn');
        const fundInput = document.getElementById('fundInput');
        
        // Wallet option buttons
        const phantomBtn = document.getElementById('phantomBtn');
        const solflareBtn = document.getElementById('solflareBtn');
        const backpackBtn = document.getElementById('backpackBtn');
        const demoBtn = document.getElementById('demoBtn');

        // Render functions
        function renderQueue() {
            const container = document.getElementById('queueList');
            container.innerHTML = state.queue.map((item, idx) => `
                <div class="queue-item">
                    <span>${idx + 1}. ${item.name}</span>
                    <div class="queue-details">Cost ${item.cost} SOL ‚Ä¢ Est. Profit ${item.profit} SOL</div>
                </div>
            `).join('');
        }

        function updateProgress() {
            document.getElementById('progressPercent').textContent = `Progress: ${Math.round(state.progress)}%`;
            document.getElementById('progressFill').style.width = state.progress + '%';
            document.getElementById('progressText').textContent = Math.round(state.progress) + '%';
            document.getElementById('modalProgress').textContent = Math.round(state.progress);
        }

        function updateItem() {
            document.getElementById('itemName').textContent = state.currentItem.name;
            document.getElementById('itemSource').textContent = state.currentItem.source;
            document.getElementById('itemCost').textContent = state.currentItem.cost + ' SOL';
            document.getElementById('itemProfit').textContent = '+' + state.currentItem.profit + ' SOL';
        }

        // Wallet connection functions
        function connectWallet(walletType) {
            if (walletType === 'demo') {
                // Demo mode - simulate connection
                state.connected = true;
                state.walletAddress = 'DemoWalletAddress123...';
                walletBtn.textContent = 'DEMO MODE';
                walletBtn.classList.add('connected');
                walletModal.classList.remove('active');
                alert('Demo mode activated! You can now test the app functionality.');
                return;
            }

            // Check if Solana wallet is available
            if (typeof window.solana === 'undefined' && walletType === 'phantom') {
                alert('Phantom wallet not detected. Please install Phantom wallet from https://phantom.app/');
                return;
            }

            // Simulate wallet connection (in a real app, you'd use the actual wallet connection)
            try {
                state.connected = true;
                state.walletAddress = generateMockAddress();
                
                walletBtn.textContent = shortenAddress(state.walletAddress);
                walletBtn.classList.add('connected');
                walletModal.classList.remove('active');
                
                console.log(`Connected to ${walletType} wallet: ${state.walletAddress}`);
                alert(`Successfully connected to ${walletType}!`);
            } catch (error) {
                console.error('Wallet connection failed:', error);
                alert(`Failed to connect to ${walletType}. Please try again.`);
            }
        }

        function disconnectWallet() {
            state.connected = false;
            state.walletAddress = null;
            walletBtn.textContent = 'Connect Wallet';
            walletBtn.classList.remove('connected');
            alert('Wallet disconnected.');
        }

        function generateMockAddress() {
            return 'So1' + Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
        }

        function shortenAddress(address) {
            if (!address) return '';
            return address.substring(0, 4) + '...' + address.substring(address.length - 4);
        }

        // Event Listeners
        walletBtn.addEventListener('click', () => {
            if (state.connected) {
                disconnectWallet();
            } else {
                walletModal.classList.add('active');
            }
        });

        // Wallet option buttons
        phantomBtn.addEventListener('click', () => connectWallet('phantom'));
        solflareBtn.addEventListener('click', () => connectWallet('solflare'));
        backpackBtn.addEventListener('click', () => connectWallet('backpack'));
        demoBtn.addEventListener('click', () => connectWallet('demo'));

        closeWalletBtn.addEventListener('click', () => {
            walletModal.classList.remove('active');
        });

        // Fund button
        fundBtn.addEventListener('click', () => {
            if (!state.connected) {
                alert('Please connect your wallet first.');
                return;
            }
            fundModal.classList.add('active');
        });

        // Cancel modal
        cancelBtn.addEventListener('click', () => {
            fundModal.classList.remove('active');
            fundInput.value = '';
        });

        // Confirm funding
        confirmBtn.addEventListener('click', () => {
            const amt = parseFloat(fundInput.value);
            if (isNaN(amt) || amt <= 0) {
                alert('Please enter a valid amount.');
                return;
            }

            const contrib = Math.min(amt, state.currentItem.cost * (100 - state.progress) / 100);
            const newProgress = Math.min(100, state.progress + (contrib / state.currentItem.cost) * 100);
            
            state.progress = newProgress;
            updateProgress();
            
            fundModal.classList.remove('active');
            fundInput.value = '';

            if (newProgress >= 100) {
                startFlip();
            }
        });

        // Start flip
        function startFlip() {
            state.flipping = true;
            state.flipTimer = 90;
            fundBtn.disabled = true;
            fundBtn.textContent = 'FLIPPING IN PROGRESS';
            
            const statusAlert = document.getElementById('statusAlert');
            statusAlert.style.display = 'block';
            
            const interval = setInterval(() => {
                state.flipTimer--;
                const mins = Math.floor(state.flipTimer / 60);
                const secs = state.flipTimer % 60;
                statusAlert.textContent = `[RESALE IN PROGRESS] ${mins}:${secs.toString().padStart(2, '0')} remaining`;
                
                if (state.flipTimer <= 0) {
                    clearInterval(interval);
                    completeFlip();
                }
            }, 1000);
        }

        // Complete flip
        function completeFlip() {
            state.flipping = false;
            
            document.getElementById('statusAlert').style.display = 'none';
            fundBtn.disabled = false;
            fundBtn.textContent = 'FUND THIS FLIP';
            
            if (state.queue.length > 0) {
                state.currentItem = state.queue[0];
                state.queue.shift();
                state.progress = Math.floor(Math.random() * 40 + 20);
                
                updateItem();
                updateProgress();
                renderQueue();
            }
        }

        // Initial render
        renderQueue();
        updateProgress();
        updateItem();

        // Test that buttons are working
        console.log('Buttons should now be clickable!');
    </script>
</body>
</html>